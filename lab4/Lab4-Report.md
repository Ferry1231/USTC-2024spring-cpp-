# Lab4 Report
## 学号：PB22111678
## 姓名：刘俸源

## 问题描述
### 1. 主成分分析
主成分分析是一种数据降维技术,我们需要将高维数据降为低维数据，并尽可能的保证信息损失最小化，本题中需要对提供的iris数据集进行PCA
### 2. SVD分解
奇异值分解，本实验中自行创建$4 × 3$随机矩阵并对其进行奇异值分解
## 问题分析
- PCA主要步骤如下：
  1. 将去中心化的数据向量按列排列构成$n × m$矩阵$X$
  2. 计算协方差矩阵$\frac 1 m XX^T$
  3. 应用Jacobi方法求解$\frac 1 m XX^T$的所有特征值
  4. 提取最大的两个特征值，计算对应的单位特征向量作为我们视觉平面的两个基$e_1, e_2$，计算这组数据在这一平面上的投影，投影坐标的计算$xi =< x, e_i >$ ，并可视化展示结果
- SVD主要步骤如下：
  1. 对实矩阵A,应用Jacobi方法法计算$AA^T$的特征值$\lambda_1>=\lambda_2>=...>=\lambda_n$
  2. 计算$AA^T$各个特征值对应的单位特征向量组成矩阵$U$
  3. 计算$A^TA$各个特征值对应的单位特征向量组成矩阵$V$
  4. 计算$\Sigma=diag(\sqrt \lambda_1,\sqrt \lambda_2,...\sqrt \lambda_n)$

题目额外要求：
1. 构建给定大小随机矩阵
2. 实现文件读写
3. 可视化

可见问题核心在于实现Jacobbi分解求解对称实矩阵特征值，并逐次实现PCA方法，SVD方法，并在最后使用python绘图进行结果可视化
## 求解方法
构建三个C++类，分别为Jacobbi，SVD，PCA并逐次实现。使用python的matplotlib及numpy模块进行数据可视化
## 实验结果
### (a)
初始矩阵A:
|$0.07$|$0.49$|$0.73$|
|---|---|---|   
|$0.58$|$0.3$|$0.72$|
|$0.44$|$0.78$|$0.23$|
|$0.09$|$0.4$|$0.65$|

#### Jacobi分解
迭代中每次更新的矩阵非对角元素平方和：<br>
sum: 3.77045<br>
sum: 2.04743<br>
sum: 0.0136925<br>
sum: 0.00427393<br>
sum: 0.00274824<br>
sum: 0.00130609<br>
sum: 0.000111294<br>
sum: 3.17075e-06<br>
sum: 1.05074e-07<br>
sum: 6.46387e-09<br>
sum: 1.82849e-09<br>
sum: 6.45523e-11<br>
sum: 9.26736e-14<br>
<br>

#### SVD分解

$U$:

|$0.511006$|$-0.358201$|$0.458509$|$-0.632719$|
|:---:|:---:|:---:|:---:|  
|$0.553476$|$-0.145339$|$-0.817645$|$-0.0632304$|
|$0.481335$|$0.859284$|$0.171054$|$0.0262335$|
|$0.448167$|$-0.334962$|$0.303261$|$0.771349$|

$\Sigma$:

|$1.64046$|$0$|$0$|
|:---:|:---:|:---:|
|$0$|$0.553766$|$0$|
|$0$|$0$|$0.412828$|
|$0$|$0$|$0$|

$V^T$

|$0.371181$|$0.591994$|$0.715379$|
|:---:|:---:|:---:|   
|$0.43081$|$0.57269$|$-0.697445$|
|$0.822574$|$-0.567071$|$0.0424649$|

### (b)
#### 协方差矩阵

$\frac 1 m XX^T$:

|$0.681122$|$-0.0390067$|$1.26519$|$0.513458$|
|:---:|:---:|:---:|:---:|
|$-0.0390067$|$0.1867515$|$-0.319568$|$-0.117195$|
|$1.26519$|$-0.319568$|$0.000137441$|$1.28774$|
|$0.513458$|$-0.117195$|$1.28774$|$0.578532$|

#### 可视化结果
![alt text](lab4c.png)

## 结果分析
### (a)
非对角线元素平方和呈下降趋势；
对于求得的四个特征值，分别计算$det(AA^T-\lambda_iI)$如下（按特征值大小排列）：
1. $\lambda_1$: 0.00005227
2. $\lambda_2$: -0.00000004
3. $\lambda_3$: 0.00000002
4. $\lambda_4$: 0.00000000
### (b)
该图共有两个坐标轴，横轴为$x_1$，纵轴为$x_2$，分别代表着对原数据经过PCA后，在最大的两个特征值对应的单位特征向量上的投影值；标签为0，1，2的数据在图中分别以红色、绿色、蓝色呈现。